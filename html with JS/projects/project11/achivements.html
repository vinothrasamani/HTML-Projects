<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>achivements</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="upload.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="shortcut icon" href="assets/logoimg.png" type="image/x-icon">
</head>
<body onload="listpdfs()">
    <div id="top">
        <nav>
            <div class="title">
                <img src="assets/img.jpeg" alt="Friends group images">
                <a href="index.html"><h1 class="name">Friends profiles</h1></a>
            </div>
            <div class="menu">
                <li hidden class="cancel" onclick="cancel();"><i class="fa-solid fa-xmark"></i></li>
                <a href="index.html"><li>Home</li></a>
                <a href="achivements.html"><li>Achivemnts</li></a>
                <a href="photos.html"><li>Photos</li></a>
                <a href="videos.html"><li>Videos</li></a>
                <a href="chat.html"><li>Chats</li></a>
                <a href="stories.html"><li>Stories</li></a>
                <a href="contact.html"><li>Contact</li></a>
            </div>
            <li class="menu-icon" onclick="hovermenu();"><i class="fa-solid fa-bars"></i></li>
        </nav>
    </div>
    <div id="achivements">
        <a href="" target="_blank"></a>
        <h1>Achivements</h1>
        <div class="add-achive">
            <p>Add achivements of  yours as a PDF file like Certificates..</p>
            <div>
                <input type="file" name="Achivements" class="achivement" accept=".pdf, .doc, .docx" onchange="upload(event);" multiple>
            </div>
        </div>
        <div class="achivements-list">
            <h3>Uploaded Documents</h3><hr>
            <div class="list">
                
            </div>
        </div>
    </div>
    <div id="loader">
        <div class="circle">
            <div class="wave"></div>
        </div>
    </div>
    <div id="foot">
        <footer>
            <div class="parts">
                <div class="part1">
                    <h3>Quick links</h3>
                        <ul>
                            <li><a href="achivements.html">Achivemnts</a></li>
                            <li><a href="photos.html">Photos</a></li>
                            <li><a href="videos.html">Videos</a></li>
                            <li><a href="chat.html">Chats</a></li>
                            <li><a href="stories.html">Stories</a></li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                </div>
                <div class="part2">
                    <h3>Locations</h3>
                    <div>
                        <a href="#" target="new"><i class="fa-solid fa-location-dot" style="color: #00ffbb;font-size:20px;"></i>
                            <b>Vinoth.A : </b><i>Mathukkarampatti, natham, Dindigul-624401.</i> </a><br>
                        <a href="#" target="new"><i class="fa-solid fa-location-dot" style="color: #00ffbb;font-size:20px;"></i>
                            <b>TharvinRaja.S : </b><i>Sirugudi, natham, Dindigul-624401.</i> </a><br>
                        <a href="#" target="new"><i class="fa-solid fa-location-dot" style="color: #00ffbb;font-size:20px;"></i>
                            <b>Saravanakumar.T : </b><i>Eriyodu, Dindigul-624401.</i></a><br>
                        <a href="#" target="new"><i class="fa-solid fa-location-dot" style="color: #00ffbb;font-size:20px;"></i>
                            <b>Santhosh.P.A : </b><i>Madurai</i></a>
                    </div>
                </div>
                <div class="part3">
                    <h3>Contacts</h3>
                    <ul>
                        <abbr title="Whatsapp">
                            <i class="fa-brands fa-whatsapp fa-sl" onclick="setlink(`https:`+'/'+`/wa.me/qr/AEM5ZNNA32HYD1`, `https:`+`/`+`/wa.me/qr/KRJ5KY3HIAPYE1`, `https:`+`/`+`/wa.me/qr/YSDJ6Z3QEN65E1`, `https:`+`/`+`/wa.me/qr/XTZ4TVHII24XG1`, 0);" style="background:none; color: #077c05;font-size:30px;"></i></abbr>
                        <abbr title="Facebook">
                            <i class="fa-brands fa-facebook fa-sl" onclick="setlink(`https:`+`/`+`/www.facebook.com/profile.php?id=100094141524250&mibextid=ZbWKwL`, `https:`+`/`+`/www.facebook.com/saravnan.kumar.75?mibextid=ZbWKwL`, `https:`+`/`+`/www.facebook.com/profile.php?id=100043321031995&mibextid=ZbWKwL`, `https:`+`/`+`/www.facebook.com/profile.php?id=61551088010846&mibextid=ZbWKwL`, 1);" style="color: #0162f4; background:none;font-size:30px;"></i></abbr>
                        <abbr title="Email">
                            <i class="fa-regular fa-envelope fa-sl" onclick="setlink('mailto:vinothrasamani@gmail.com','mailto:tsaravanakumar252002@gmail.com','mailto:santhosh9655872281@gmail.com', 'mailto:tharvinraja96@gmail.com', 2);" style="color: #1b61da;background:none;font-size:30px;"></i></abbr>
                        <abbr title="Linkedin">
                            <i class="fa-brands fa-linkedin fa-sl" onclick="setlink(`https:`+`/`+`/www.linkedin.com/in/vinoth-a-629b13285`, `https:`+`/`+`/www.linkedin.com/in/saravana-kumar-571b7b29b`, `https:`+`/`+`/www.linkedin.com/in/pa-santhosh-314a6a288?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app`, `https:`+`/`+`/www.linkedin.com/in/tharvinraja-s-49a0012a0?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app`, 3);" style="color: #2d68ce;font-size:30px;"></i></abbr>
                        <abbr title="Twitter">
                            <i class="fa-brands fa-square-twitter fa-sl" onclick="setlink(`https:`+`/`+`/twitter.com/49_vinoth_cse/`,'kumar.com','san.com', `https:`+`/`+`/x.com/tharvinraja_96?t=rO3tGi9OPa1mPIqdqvmoJA&s=08`, 4);" style="color: #2d68ce;font-size:30px;"></i></abbr>
                        <abbr title="Instagram">
                            <i class="fa-brands fa-square-instagram fa-sl" onclick="setlink(`https:`+`/`+`/www.instagram.com/vino_th4049?igsh=YzljYTk1ODg3Zg==`, `https:`+`/`+`/www.instagram.com/saravana_kumar.18?igsh=MXR3OW9mZ2hlZ2ln`, `https:`+`/`+`/www.instagram.com/santh.osh957?igsh=YzljYTk1ODg3Zg==`, `https:`+`/`+`/www.instagram.com/dio_str_96?igsh=YzljYTk1ODg3Zg==`, 5);" style="color: #ff00dd;font-size:30px;"></i></abbr>
                        <abbr title="Github">
                            <i class="fa-brands fa-github fa-sl" onclick="setlink(`https:`+`/`+`/github.com/vinothrasamani`, `https:`+`/`+`/github.com/SaravanakumarThavamani`, `https:`+`/`+`/github.com/9655872281`, `https:`+`/`+`/github.com/Tharvinraja96/`, 6);" style="color: #c3c3c3;font-size:30px;"></i></abbr>
                    </ul>
                    <div class="links" onmouseleave="removelink();">
                        <div>
                            <a href="" target="_blank"><img src="assets/vinoth.jpg" alt="Vinoth"></a>
                            <a href="" target="_blank"><img src="assets/mass-saravana (2).jpg" alt="Saravanakumar"></a>
                            <a href="" target="_blank"><img src="assets/san.jpeg" alt="Santhosh"></a>
                            <a href="" target="_blank"><img src="assets/raja.jpeg" alt="TharvinRaja"></a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <div class="copy">
            <h4>SSTV&COPY;2024</h4>
        </div>
    </div>

    <script type="text/javascript">
        var menu = document.querySelector('#top nav .menu');
        var menubar = document.querySelector('#top nav .menu-icon');
        var links = document.querySelector('#foot footer .parts .part3 .links');
        var changeval = 0, k = 0;

        function interval(){
                setInterval(() => {
                    if(window.innerWidth > 880){
                        clearInterval(0);
                        menu.style.display = "flex";
                        menubar.style.display = "none";
                        k = 1;
                    }else{
                        if(k == 1){
                            k=0;
                            cancel();
                        }
                    }
                }, 500);
            }
        
        function hovermenu(){
                menu.style.display = "block";
                menubar.style.display = "none";
        }

        function cancel(){
                menu.style.display = "none";
                menubar.style.display = "block";
                interval();
        }
        
        function setlink(vinoth, kumar, san, tharvin,c){
            var colorof = new Array("#00a000","#0500a0","#940f00","#9d9d9d","#00a9cf","#b1008d","#4c4c4c");
            links.style.display = "flex";
            console.log(colorof[c]);
            document.querySelector('#foot footer .parts .part3 .links div').style.boxShadow = '0px 0px 10px 5px ' + colorof[c];
            document.querySelector('#foot footer .parts .part3 .links div a:nth-child(1)').href = vinoth;
            document.querySelector('#foot footer .parts .part3 .links div a:nth-child(2)').href = kumar;
            document.querySelector('#foot footer .parts .part3 .links div a:nth-child(3)').href = san;
            document.querySelector('#foot footer .parts .part3 .links div a:nth-child(4)').href = tharvin; 
        }
        
        function removelink(){
            links.style.display = "none";
}
    </script>
    <!-- <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-storage.js"></script>     -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase.js"></script>
    <script type="text/javascript">
        const firebaseConfig = {
            apiKey: "AIzaSyB7_yalPWoyHbBmAxkIRfBtRt0Mbc4FGU0",
            authDomain: "friends-resume.firebaseapp.com",
            databaseURL: "https://friends-resume-default-rtdb.firebaseio.com",
            projectId: "friends-resume",
            storageBucket: "friends-resume.appspot.com",
            messagingSenderId: "922315528130",
            appId: "1:922315528130:web:2b65e1b4c531e842ab685b"
        };
        firebase.initializeApp(firebaseConfig);

        var loadof = document.querySelector('#loader');
        var list = document.querySelector('#achivements .achivements-list .list');

        var pdf_name, item, count;
        var username;
        const auth = firebase.auth();
        auth.onAuthStateChanged((user) => {
            if (user) {
                username = user.email;
                console.log(user.email.split("@")[0]);
            } else {
                window.location.href = 'chat.html';
            }
        });

        function upload(e) {
            const files = e.target.files;
            const promises = [];
        
            for (let i = 0; i < files.length; i++) {
                const item = files[i];
                const pdf_name = item.name;
                const storageref = firebase.storage().ref("pdf's/" + pdf_name);
                const uploadtask = storageref.put(item);
        
                promises.push(
                    new Promise((resolve, reject) => {
                        uploadtask.on(
                            "state_changed",
                            (snapshot) => {
                                // Track upload progress if needed
                                console.log(snapshot);
                            },
                            (error) => {
                                console.log("Error: " + error);
                                reject(error);
                            },
                            () => {
                                uploadtask.snapshot.ref
                                    .getDownloadURL()
                                    .then((url) => {
                                        console.log("URL: " + url);
                                        resolve();
                                    })
                                    .catch((error) => {
                                        console.error("Error getting download URL:", error);
                                        reject(error);
                                    });
                            }
                        );
                    })
                );
            }
        
            Promise.all(promises)
                .then(() => {
                    console.log("All files uploaded successfully.");
                    listpdfs(); 
                })
                .catch((error) => {
                    console.error("Error uploading files:", error);
                });
        }

    
        function listpdfs(){
            loadof.style.display = "block";
            var storageRef = firebase.storage().ref(`pdf's/`); // Adjust the directory path as needed

            storageRef.listAll().then((result) => {
                let promises = [];
                result.items.forEach((itemRef) => {
                    // Get the download URL for each item
                    promises.push(itemRef.getDownloadURL());
                });

                // Wait for all promises to resolve
                return Promise.all(promises);
            }).then((urls) => {
                list.innerHTML = ''; // Clear the list before appending new URLs
                urls.forEach((url) => {
                    var imgdiv = document.createElement('div');
                    imgdiv.classList.add('img');
                    var pdffile = document.createElement('a');
                    pdffile.href = url;
                    pdffile.target = '_blank';
                    var pdfimg = document.createElement('img');
                    pdfimg.src = "https://banner2.cleanpng.com/20180802/ezo/kisspng-pdf-computer-file-clip-art-file-format-document-international-conference-on-materials-energy-april-5b630034a89c51.9879975015332147726906.jpg";
                    pdffile.appendChild(pdfimg);
                    var info = document.createElement('div');
                    var logo = document.createElement('i');
                    logo.classList.add('fa-solid');
                    logo.classList.add('fa-file');
                    var nameof = document.createElement('span');
                    nameof.textContent = truncateFileName(getFileNameFromUrl(url));
                    info.appendChild(logo);
                    info.appendChild(nameof);
                    pdffile.appendChild(info);
                    imgdiv.appendChild(pdffile);
                    list.appendChild(imgdiv);
                });
                loadof.style.display = "none";
            }).catch((error) => {
                console.error("Error listing files: ", error);
                loadof.style.display = "none";
            });
        }

        function getFileNameFromUrl(url) {
            const path = decodeURIComponent(url.split('?')[0]); 
            return path.substring(path.lastIndexOf('/') + 1);
        }

        function truncateFileName(fileName) {
            if (fileName.length > 20) {
                return fileName.substring(0, 20) + '...';
            }
            return fileName;
        }
    </script>
</body>
</html>
